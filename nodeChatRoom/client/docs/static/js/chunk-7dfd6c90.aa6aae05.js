(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dfd6c90"],{"0273":function(t,e,s){var n=s("c1b2"),a=s("4180"),i=s("2c6c");t.exports=n?function(t,e,s){return a.f(t,e,i(1,s))}:function(t,e,s){return t[e]=s,t}},"06fa":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},1561:function(t,e,s){"use strict";var n=s("c213"),a=s.n(n);a.a},"158e":function(t,e,s){},"15da":function(t,e,s){"use strict";var n=s("efb1"),a=s.n(n);a.a},1875:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},"194a":function(t,e,s){var n=s("cc94");t.exports=function(t,e,s){if(n(t),void 0===e)return t;switch(s){case 0:return function(){return t.call(e)};case 1:return function(s){return t.call(e,s)};case 2:return function(s,n){return t.call(e,s,n)};case 3:return function(s,n,a){return t.call(e,s,n,a)}}return function(){return t.apply(e,arguments)}}},"2c6c":function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"3ac6":function(t,e,s){(function(e){var s=function(t){return t&&t.Math==Math&&t};t.exports=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof e&&e)||Function("return this")()}).call(this,s("c8ba"))},"3e47":function(t,e,s){var n=s("a5eb"),a=s("c1b2"),i=s("4180");n({target:"Object",stat:!0,forced:!a,sham:!a},{defineProperty:i.f})},4180:function(t,e,s){var n=s("c1b2"),a=s("77b2"),i=s("6f8d"),r=s("7168"),o=Object.defineProperty;e.f=n?o:function(t,e,s){if(i(t),e=r(e,!0),i(s),a)try{return o(t,e,s)}catch(n){}if("get"in s||"set"in s)throw TypeError("Accessors not supported");return"value"in s&&(t[e]=s.value),t}},"44ba":function(t,e,s){var n=s("c1b2"),a=s("7043"),i=s("2c6c"),r=s("a421"),o=s("7168"),c=s("78e7"),u=s("77b2"),l=Object.getOwnPropertyDescriptor;e.f=n?l:function(t,e){if(t=r(t),e=o(e,!0),u)try{return l(t,e)}catch(s){}if(c(t,e))return i(!a.f.call(t,e),t[e])}},"466d":function(t,e,s){"use strict";var n=s("d784"),a=s("825a"),i=s("50c4"),r=s("1d80"),o=s("8aa5"),c=s("14c3");n("match",1,(function(t,e,s){return[function(e){var s=r(this),n=void 0==e?void 0:e[t];return void 0!==n?n.call(e,s):new RegExp(e)[t](String(s))},function(t){var n=s(e,t,this);if(n.done)return n.value;var r=a(t),u=String(this);if(!r.global)return c(r,u);var l=r.unicode;r.lastIndex=0;var f,p=[],d=0;while(null!==(f=c(r,u))){var h=String(f[0]);p[d]=h,""===h&&(r.lastIndex=o(u,i(r.lastIndex),l)),d++}return 0===d?null:p}]}))},"478d":function(t,e,s){},"638c":function(t,e,s){var n=s("06fa"),a=s("fc48"),i="".split;t.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==a(t)?i.call(t,""):Object(t)}:Object},"6f8d":function(t,e,s){var n=s("dfdb");t.exports=function(t){if(!n(t))throw TypeError(String(t)+" is not an object");return t}},7043:function(t,e,s){"use strict";var n={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,i=a&&!n.call({1:2},1);e.f=i?function(t){var e=a(this,t);return!!e&&e.enumerable}:n},7168:function(t,e,s){var n=s("dfdb");t.exports=function(t,e){if(!n(t))return t;var s,a;if(e&&"function"==typeof(s=t.toString)&&!n(a=s.call(t)))return a;if("function"==typeof(s=t.valueOf)&&!n(a=s.call(t)))return a;if(!e&&"function"==typeof(s=t.toString)&&!n(a=s.call(t)))return a;throw TypeError("Can't convert object to primitive value")}},"764b6":function(t,e){t.exports={}},"77b2":function(t,e,s){var n=s("c1b2"),a=s("06fa"),i=s("7a37");t.exports=!n&&!a((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},"78e7":function(t,e){var s={}.hasOwnProperty;t.exports=function(t,e){return s.call(t,e)}},"7a37":function(t,e,s){var n=s("3ac6"),a=s("dfdb"),i=n.document,r=a(i)&&a(i.createElement);t.exports=function(t){return r?i.createElement(t):{}}},"85d3":function(t,e,s){t.exports=s("9a13")},9426:function(t,e,s){"use strict";var n=s("158e"),a=s.n(n);a.a},"9a13":function(t,e,s){t.exports=s("a38c")},a0e5:function(t,e,s){var n=s("06fa"),a=/#|\.prototype\./,i=function(t,e){var s=o[r(t)];return s==u||s!=c&&("function"==typeof e?n(e):!!e)},r=i.normalize=function(t){return String(t).replace(a,".").toLowerCase()},o=i.data={},c=i.NATIVE="N",u=i.POLYFILL="P";t.exports=i},a38c:function(t,e,s){s("3e47");var n=s("764b6"),a=n.Object,i=t.exports=function(t,e,s){return a.defineProperty(t,e,s)};a.defineProperty.sham&&(i.sham=!0)},a421:function(t,e,s){var n=s("638c"),a=s("1875");t.exports=function(t){return n(a(t))}},a5eb:function(t,e,s){"use strict";var n=s("3ac6"),a=s("44ba").f,i=s("a0e5"),r=s("764b6"),o=s("194a"),c=s("0273"),u=s("78e7"),l=function(t){var e=function(e,s,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,s)}return new t(e,s,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e};t.exports=function(t,e){var s,f,p,d,h,g,m,v,b,C=t.target,E=t.global,y=t.stat,O=t.proto,I=E?n:y?n[C]:(n[C]||{}).prototype,T=E?r:r[C]||(r[C]={}),_=T.prototype;for(d in e)s=i(E?d:C+(y?".":"#")+d,t.forced),f=!s&&I&&u(I,d),g=T[d],f&&(t.noTargetGet?(b=a(I,d),m=b&&b.value):m=I[d]),h=f&&m?m:e[d],f&&typeof g===typeof h||(v=t.bind&&f?o(h,n):t.wrap&&f?l(h):O&&"function"==typeof h?o(Function.call,h):h,(t.sham||h&&h.sham||g&&g.sham)&&c(v,"sham",!0),T[d]=v,O&&(p=C+"Prototype",u(r,p)||c(r,p,{}),r[p][d]=h,t.real&&_&&!_[d]&&c(_,d,h)))}},c1b2:function(t,e,s){var n=s("06fa");t.exports=!n((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},c213:function(t,e,s){},c5e8:function(t,e,s){},cc94:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},d345:function(t,e,s){},d655:function(t,e,s){"use strict";var n=s("478d"),a=s.n(n);a.a},d840:function(t,e,s){"use strict";var n=s("d345"),a=s.n(n);a.a},dfdb:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},e445:function(t,e,s){"use strict";var n=s("c5e8"),a=s.n(n);a.a},efb1:function(t,e,s){},f7c1:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chatDetail"},[s("div",{staticClass:"left"},[t.userName&&"undefined"!==t.userName?s("div",{staticClass:"searchbar-wrap"},[s("searchbar"),s("div",{staticClass:"action-add"},[s("a-icon",{attrs:{type:"plus-square"},on:{click:t.groupAddModal}})],1)],1):t._e(),s("listitem",{staticClass:"left-list",attrs:{list:t.list}})],1),s("div",{staticClass:"right"},[s("headerbar",{ref:"headerbar",attrs:{title:t.groupInfo.GROUPNAME},on:{toggle:t.toggle}}),s("chat",{staticClass:"chat-wrap",attrs:{list:t.historyChats}}),s("div",{staticClass:"more-introduce",class:{show:t.isOpen}},[s("managepanel",{attrs:{group:t.groupInfo,list:t.groupUsers}})],1)],1),s("a-modal",{attrs:{title:"创建群聊",visible:t.groupVisible,confirmLoading:t.groupConfirmLoading},on:{ok:t.groupInfoAdd,cancel:t.groupCancel}},[s("div",[s("p",[t._v("请输入群聊名称")]),s("a-input",{model:{value:t.groupName,callback:function(e){t.groupName=e},expression:"groupName"}})],1)])],1)},a=[],i=s("85d3"),r=s.n(i);function o(t,e,s){return e in t?r()(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat"},[s("ul",{staticClass:"message-list"},t._l(t.list,(function(e){return s("li",{key:e.MESSAGEID,staticClass:"chat-item"},[s("p",{staticClass:"time-show"},[s("span",{staticClass:"time"},[t._v(t._s(e.TIME))])]),e.USERNAME!==t.userName?s("div",{staticClass:"chat-conversation them"},[s("img",{staticClass:"avatar",attrs:{src:e.AVATAR,alt:""}}),s("div",{staticClass:"chat-message"},[s("span",{staticClass:"chat-user"},[t._v(t._s(e.USERNAME))]),s("div",{staticClass:"chat-popover"},[t._v(t._s(e.CONTENT))])])]):t._e(),e.USERNAME===t.userName?s("div",{staticClass:"chat-conversation me"},[s("div",{staticClass:"chat-message"},[s("div",{staticClass:"chat-popover"},[t._v(t._s(e.CONTENT))])]),s("img",{staticClass:"avatar",attrs:{src:e.AVATAR,alt:""}})]):t._e()])})),0),t.userName&&"undefined"!==t.userName?s("div",{staticClass:"sendMessage"},[t._m(0),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"message-control",attrs:{rows:"3",cols:"20"},domProps:{value:t.message},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage(e)},input:function(e){e.target.composing||(t.message=e.target.value)}}}),s("div",{staticClass:"send-control"},[t.showTips?s("div",{staticClass:"popover"},[s("div",{staticClass:"tips"},[t._v(t._s(t.tips))])]):t._e(),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:t.sendMessage}},[t._v(" 发送(S) ")])])]):t._e(),t.userName&&"undefined"!==t.userName?t._e():s("div",{staticClass:"dontSend"},[t._v(" 您现在是游客身份,请"),s("a",{staticClass:"link",on:{click:t.sigin}},[t._v("登录")]),t._v("后一起参与讨论吧！ ")])])},u=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"message-toolbar"},[s("div",{staticClass:"message-toolbar-left"}),s("div",{staticClass:"message-toolbar-left"})])}],l=(s("ac1f"),s("466d"),s("ed08")),f=s("2b0e"),p=new f["a"],d={name:"Chat",props:{list:Array},data:function(){return{userInfo:Object(l["d"])(),userName:Object(l["e"])(),chatContent:{},message:"",tips:"不能发送空白消息",showTips:!1}},mounted:function(){},created:function(){var t=this;setTimeout((function(){t.scrollTop()}),50)},methods:{sigin:function(){this.$router.push("/signin")},sendMessage:function(){var t=this;console.log(1==this.message,"this.message ==="),this.message.match(/^\s*$/)?(this.showTips=!0,setTimeout((function(){t.showTips=!1}),3e3)):(p.$emit("send",{message:this.message}),setTimeout((function(){t.scrollTop(),t.message="",t.showTips=!1}),50))},scrollTop:function(){this.chatContent=document.querySelector(".message-list"),this.chatContent.scrollTop=this.chatContent.scrollHeight}}},h=d,g=(s("15da"),s("2877")),m=Object(g["a"])(h,c,u,!1,null,null,null),v=m.exports,b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"headerbar"},[t.left?s("span",{staticClass:"left"},[t._v(t._s(t.left))]):t._e(),t.title?s("span",{staticClass:"title"},[t._v(t._s(t.title))]):t._e(),s("i",{staticClass:"icon iconfont icon-gengduo more toggle",on:{click:t.toggle}})])},C=[],E={name:"HeaderBar",props:["title","more","left"],data:function(){return{userName:Object(l["e"])()}},methods:{toggle:function(){p.$emit("toggle")}}},y=E,O=(s("9426"),Object(g["a"])(y,b,C,!1,null,null,null)),I=O.exports,T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{staticClass:"list-item"},t._l(t.list,(function(e,n){return s("li",{key:e.ID,staticClass:"list-item-every",class:{active:t.currentIndex===n},on:{click:function(s){return t.changeMessage(e,n)}}},[s("img",{staticClass:"avatar",attrs:{src:e.AVATAR,alt:"avator"}}),s("div",{staticClass:"list-item-right"},[s("div",{staticClass:"list-item-header"},[s("span",{staticClass:"title"},[t._v(t._s(e.GROUPNAME))]),s("span",{staticClass:"time"},[t._v(t._s(e.LATEDTIME))])]),s("div",{staticClass:"list-item-content"},[s("span",{staticClass:"text"},[t._v(t._s(e.content))]),s("i",{staticClass:"icon iconfont"})])])])})),0)},_=[],R={name:"ListItem",props:["list"],data:function(){return{currentIndex:0}},methods:{changeMessage:function(t,e){this.currentIndex=e,p.$emit("change",t)}}},A=R,S=(s("d655"),Object(g["a"])(A,T,_,!1,null,null,null)),x=S.exports,M=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ManagePanel"},[s("div",{staticClass:"header"},[s("searchbar",{on:{search:t.search}})],1),s("div",{staticClass:"content"},[s("div",{staticClass:"contacts"},[s("div",{staticClass:"contacts-list-wrap"},[s("ul",{staticClass:"contacts-list"},[s("h5",[t._v("在线用户 "+t._s(t.list.length)+" 人")]),t._l(t.list,(function(e){return s("li",{key:e.ID,staticClass:"contacts-list-item"},[s("img",{attrs:{src:e.AVATAR,alt:""}}),s("span",{staticClass:"text",attrs:{title:e.USERNAME}},[t._v(t._s(e.USERNAME))])])}))],2)])]),s("div",{staticClass:"manage-setting"},[s("span",{staticClass:"title"},[t._v("群名")]),s("div",{staticClass:"setting-item"},[s("span",{staticClass:"text",attrs:{contentEditable:"true"}},[t._v(t._s(t.group.GROUPNAME))]),s("i",{staticClass:"icon iconfont icon-xiugai"})])]),s("div",{staticClass:"manage-setting"},[s("span",{staticClass:"title"},[t._v("群公告")]),s("div",{staticClass:"setting-item"},[s("span",{staticClass:"text",attrs:{contentEditable:"true"}},[t._v(t._s(t.group.GROUPREMARK))]),s("i",{staticClass:"icon iconfont icon-xiugai"})])]),s("div",{staticClass:"manage-setting"},[s("span",{staticClass:"title"},[t._v("我在本群的昵称")]),s("div",{staticClass:"setting-item"},[s("span",{staticClass:"text",attrs:{contentEditable:"true"}},[t._v(t._s(t.userName))]),s("i",{staticClass:"icon iconfont icon-xiugai"})])]),s("div",{staticClass:"control"},[s("a",{staticClass:"btn-opacity btn-delete",on:{click:t.deleteExit}},[t._v("删除并退出")])])])])},w=[],N=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"searchbar"},[s("i",{staticClass:"icon iconfont icon-sousuo"}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{type:"text",placeholder:"搜索"},domProps:{value:t.value},on:{click:t.search,input:function(e){e.target.composing||(t.value=e.target.value)}}})])},U=[],j={name:"SearchBar",data:function(){return{value:""}},created:function(){},methods:{search:function(){this.$emit("search",{value:this.value})}}},D=j,P=(s("d840"),Object(g["a"])(D,N,U,!1,null,null,null)),k=P.exports,G={name:"ManagePanel",components:{searchbar:k},props:["list","group"],data:function(){return{userName:Object(l["e"])()}},methods:{search:function(){},deleteExit:function(){this.$emit("exitGroup")}}},$=G,L=(s("1561"),Object(g["a"])($,M,w,!1,null,null,null)),V=L.exports,F=s("b775");function H(t){return Object(F["a"])({url:"/messageList",method:"get",params:{userId:t}})}function q(t){return Object(F["a"])({url:"/groupinfo/detail",method:"get",params:{groupId:t}})}function z(t){return Object(F["a"])({url:"/groupuser/list",method:"get",params:{groupId:t}})}function B(t){return Object(F["a"])({url:"/groupInfo/create",method:"post",data:t})}function J(t){return Object(F["a"])({url:"/history/list",method:"get",params:{GROUPID:t.GROUPID,FROMUSERID:t.FROMUSERID,TOUSERID:t.TOUSERID}})}var K={name:"chatDetail",components:{chat:v,headerbar:I,listitem:x,managepanel:V,searchbar:k},data:function(){var t;return t={historyChats:[],userName:Object(l["e"])(),passWord:"",times:0,newUser:"",online:0,leaveUser:"",connected:!1,userInfo:{},list:[],chatContent:{},groupName:"",groupInfo:"",groupUsers:[]},o(t,"groupInfo",{}),o(t,"groupVisible",!1),o(t,"groupConfirmLoading",!1),o(t,"isOpen",!1),t},computed:{},watch:{chats:function(t){return this.chats}},mounted:function(){var t=this;this.$socket.on("new message",(function(e){var s="".concat(e.message.FROMUSERID,"对大家说:"),n="".concat(e.message.CONTENT),a=e.message["AVATAR"];Object(l["f"])(s,a,n);var i={MESSAGEID:e.message.MESSAGEID,GROUPID:e.message.GROUPID,FROMUSERID:e.message.USERID,TOUSERID:e.message.TOUSERID,CONTENT:e.message.CONTENT,TIME:e.message.TIME,TS:e.message.TS,AVATAR:e.message.AVATAR,USERNAME:e.message.USERNAME};t.historyChats.push(i),setTimeout((function(){console.log(t.historyChats,"this.historyChats"),t.scrollTop()}),50)})),p.$on("send",this.addChatMessage),p.$on("toggle",this.toggle),p.$on("change",this.changeHistroy),this.getMessageList(),Object(l["d"])().then((function(e){t.userInfo=e}))},created:function(){var t=this;document.addEventListener("click",(function(e){var s=document.querySelector(".toggle"),n=document.querySelector(".ManagePanel");s&&!s.contains(e.target)&&(t.isOpen=!1),n&&n.contains(e.target)&&(t.isOpen=!0)}))},beforeDestroy:function(){},methods:{groupAddModal:function(){this.groupVisible=!0},groupInfoAdd:function(){var t=this;this.groupInfo={GROUPID:"",GROUPNAME:this.groupName,GROUPREMARK:"",CREATEUSERID:this.userInfo.USERID,CREATETIME:Object(l["a"])("yyyy-MM-dd hh:mm:ss"),DISSOLUTIONTIME:"",GROUPSTATE:"0"},B({groupInfo:this.groupInfo}).then((function(e){"0"===e.code&&(t.$message.info(e.message),t.groupVisible=!1)}))},groupCancel:function(t){this.groupVisible=!1},changeHistroy:function(t){var e=this;J(t).then((function(t){"0"===t.code&&(e.historyChats=t["data"],setTimeout((function(){e.scrollTop(),console.log(e.historyChats,"this.historyChats")}),0))})),""!==t.GROUPID&&(q(t.GROUPID).then((function(t){"0"===t.code&&(e.groupInfo=t.data)})),z(t.GROUPID).then((function(t){"0"===t.code&&(e.groupUsers=t.data)})))},getMessageList:function(){var t=this,e=this.userInfo&&this.userInfo["userId"]?this.userInfo["userId"]:void 0;H(e).then((function(e){"0"===e.code&&e.data&&e.data.length>0&&(t.list=e.data,t.changeHistroy(t.list[0]))})).catch((function(t){console.error(t)}))},toggle:function(){this.isOpen=!this.isOpen,document.body.removeEventListener("click",this.toggle)},scrollTop:function(){this.chatContent=document.querySelector(".message-list"),this.chatContent.scrollTop=this.chatContent.scrollHeight},addParticipantsMessage:function(t){var e="";1===t.numUsers?e+="there's 1 participant":e+="there are "+t.numUsers+" participants",consoloe.log(e)},connectServer:function(){this.$socket.on("connect",(function(){console.log("连接成功")}))},addChatMessage:function(t){if(t){var e={MESSAGEID:"",GROUPID:this.groupInfo.GROUPID,FROMUSERID:this.userInfo.USERID,TOUSERID:"",CONTENT:t.message,TIME:Object(l["a"])("yyyy-MM-dd hh:mm"),TS:Object(l["b"])(),AVATAR:this.userInfo.AVATAR,USERNAME:this.userInfo.USERNAME};this.$socket.emit("new message",e)}}}},W=K,Y=(s("e445"),Object(g["a"])(W,n,a,!1,null,null,null));e["default"]=Y.exports},fc48:function(t,e){var s={}.toString;t.exports=function(t){return s.call(t).slice(8,-1)}}}]);